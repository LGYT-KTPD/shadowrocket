# Shadowrocket: 外出用（WireGuard回家版·优化版）
# Version: 2025-11-01-r1  — 优化 fake-ip + 局域网 + 翻译/Lens 兼容

[General]
bypass-system = true
skip-proxy = 10.0.0.0/8,172.16.0.0/12,localhost,*.local,captive.apple.com
tun-included-routes = 192.168.1.0/24
tun-excluded-routes = 10.0.0.0/8,100.64.0.0/10,127.0.0.0/8,169.254.0.0/16,172.16.0.0/12,192.0.0.0/24,192.0.2.0/24,192.88.99.0/24,198.51.100.0/24,203.0.113.0/24,224.0.0.0/4,255.255.255.255/32,239.255.255.250/32
icmp-auto-reply = true
always-reject-url-rewrite = false
ipv6 = false
prefer-ipv6 = false

# ---------- DNS增强模块 ----------
[dns]
enable = true
listen = 0.0.0.0:53
enhanced-mode = fake-ip
# 主DNS（境外DoH + 公网混合）
nameserver = 
  https://dns.google/dns-query,
  https://cloudflare-dns.com/dns-query,
  1.1.1.1,
  8.8.8.8
# 备用DNS（境内DoH + 公网混合）
fallback = 
  https://dns.alidns.com/dns-query,
  1.0.0.1,
  9.9.9.9
# 假IP白名单（防止局域网与系统服务冲突）
fake-ip-filter = 
  *.lan,
  *.localdomain,
  *.local,
  time.apple.com,
  *.miwifi.com,
  *.tplinkwifi.net,
  routerlogin.net,
  *.google.com,
  *.googleapis.com,
  *.gstatic.com,
  *.srv.nintendo.net,
  captive.apple.com

update-url = https://raw.githubusercontent.com/LGYT-KTPD/shadowrocket/refs/heads/main/Shadowrocket_WG_fake-ip.conf

[Proxy Group]
♻️ 自动选择 = url-test, interval = 600, timeout = 8, tolerance = 80, url = http://www.gstatic.com/generate_204, policy-regex-filter = ^(?!.*(WG|WireGuard|回家|家庭|home)).*$
🚀 手动切换 = select, policy-regex-filter = .
🚀 节点选择 = select, ♻️ 自动选择, 🚀 手动切换, 🇭🇰 香港节点, 🇯🇵 日本节点, 🇸🇬 狮城节点, 🇺🇸 美国节点, 🇨🇦 加拿大节点, 🇹🇼 台湾节点, 🇬🇧 英国节点, 🇲🇾 马来节点, 🇰🇷 韩国节点, 🧭 小众节点, DIRECT
🤖 OpenAI = select, 🇺🇸 美国节点, 🇯🇵 日本节点, 🇸🇬 狮城节点, ♻️ 自动选择, 🚀 手动切换
✈️ 谷歌服务 = select, ♻️ 自动选择, 🇺🇸 美国节点, 🇭🇰 香港节点, 🇯🇵 日本节点, DIRECT
📨 电报消息 = select, ♻️ 自动选择, 🇭🇰 香港节点, 🇸🇬 狮城节点, 🇯🇵 日本节点
📺 油管视频 = select, ♻️ 自动选择, 🇭🇰 香港节点, 🇯🇵 日本节点, 🇸🇬 狮城节点, 🇺🇸 美国节点
🎬 奈飞视频 = select, 🇭🇰 香港节点, 🇹🇼 台湾节点, 🇯🇵 日本节点, 🇸🇬 狮城节点, 🇨🇦 加拿大节点
🍎 Apple服务 = select, DIRECT, ♻️ 自动选择
🌍 全球直连 = select, DIRECT, ♻️ 自动选择
🧱 广告拦截 = select, REJECT, DIRECT
🐟 漏网之鱼 = select, ♻️ 自动选择, 🚀 手动切换, 🇭🇰 香港节点, 🇯🇵 日本节点, 🇸🇬 狮城节点, 🇺🇸 美国节点, DIRECT

# 地域测速组
🇭🇰 香港节点 = url-test, interval = 600, timeout = 8, tolerance = 80, url = http://www.gstatic.com/generate_204, policy-regex-filter = (🇭🇰|HK|Hong|港|Hong Kong)
🇯🇵 日本节点 = url-test, interval = 600, timeout = 8, tolerance = 80, url = http://www.gstatic.com/generate_204, policy-regex-filter = (🇯🇵|JP|Japan|日|日本)
🇸🇬 狮城节点 = url-test, interval = 600, timeout = 8, tolerance = 80, url = http://www.gstatic.com/generate_204, policy-regex-filter = (🇸🇬|SG|Singapore|新|狮城)
🇺🇸 美国节点 = url-test, interval = 600, timeout = 8, tolerance = 80, url = http://www.gstatic.com/generate_204, policy-regex-filter = (🇺🇸|US|States|United States|美|美国)
🇨🇦 加拿大节点 = url-test, interval = 600, timeout = 8, tolerance = 80, url = http://www.gstatic.com/generate_204, policy-regex-filter = (🇨🇦|CA|Canada|加|加拿大)
🇹🇼 台湾节点 = url-test, interval = 600, timeout = 8, tolerance = 80, url = http://www.gstatic.com/generate_204, policy-regex-filter = (台|TW|Taiwan|HINET|新北|台北|中华电信)
🇬🇧 英国节点 = url-test, interval = 600, timeout = 8, tolerance = 80, url = http://www.gstatic.com/generate_204, policy-regex-filter = (🇬🇧|UK|United Kingdom|英|伦敦|London|GB)
🇲🇾 马来节点 = url-test, interval = 600, timeout = 8, tolerance = 80, url = http://www.gstatic.com/generate_204, policy-regex-filter = (🇲🇾|MY|Malaysia|马|马来)
🇰🇷 韩国节点 = url-test, interval = 600, timeout = 8, tolerance = 80, url = http://www.gstatic.com/generate_204, policy-regex-filter = (🇰🇷|KR|Korea|韩|韩国)
🧭 小众节点 = url-test, interval = 600, timeout = 8, tolerance = 120, url = http://www.gstatic.com/generate_204, policy-regex-filter = (🇷🇺|RU|Russia|🇹🇷|TR|Turkey|🇮🇳|IN|India|🇩🇪|DE|Germany|德国|🇫🇷|FR|France|法国|🇳🇱|NL|Netherlands|荷兰|🇻🇳|VN|Vietnam|越南|🇹🇭|TH|Thailand|泰国|🇵🇭|PH|Philippines|菲律宾|🇧🇷|BR|Brazil|巴西|🇦🇷|AR|Argentina|阿根廷|🇪🇸|ES|Spain|西班牙|🇮🇹|IT|Italy|意大利|🇮🇱|IL|Israel|以色列|🇦🇺|AU|Australia|澳大利亚|🇳🇿|NZ|New Zealand|新西兰|🇿🇦|ZA|South Africa|南非|🇪🇬|EG|Egypt|埃及|🇫🇮|FI|Finland|芬兰|🇸🇪|SE|Sweden|瑞典|🇳🇴|NO|Norway|挪威|🇩🇰|DK|Denmark|丹麦|🇵🇱|PL|Poland|波兰|🇨🇿|CZ|Czech|捷克|🇦🇹|AT|Austria|奥地利|🇨🇱|CL|Chile|智利|🇵🇪|PE|Peru|秘鲁|🇲🇽|MX|Mexico|墨西哥|🇨🇴|CO|Colombia|哥伦比亚|🇱🇺|LU|Luxembourg|卢森堡)

[Rule]
RULE-SET,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/BanAD.list, 🧱 广告拦截
RULE-SET,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/BanProgramAD.list, 🧱 广告拦截
RULE-SET,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/LocalAreaNetwork.list, 🌍 全球直连
RULE-SET,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaDomain.list, 🌍 全球直连
RULE-SET,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaCompanyIp.list, 🌍 全球直连
RULE-SET,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaIp.list, 🌍 全球直连
RULE-SET,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/GoogleFCM.list, ✈️ 谷歌服务
RULE-SET,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Google.list, ✈️ 谷歌服务
RULE-SET,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/GoogleCN.list, 🌍 全球直连
RULE-SET,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Apple.list, 🍎 Apple服务
RULE-SET,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Microsoft.list, 🌍 全球直连
RULE-SET,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Telegram.list, 📨 电报消息
RULE-SET,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/OpenAi.list, 🤖 OpenAI
RULE-SET,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/YouTube.list, 📺 油管视频
RULE-SET,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/Netflix.list, 🎬 奈飞视频
RULE-SET,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ProxyMedia.list, 📺 油管视频
RULE-SET,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaMedia.list, 🌍 全球直连
# 手动补充翻译与Lens修复
DOMAIN-SUFFIX,translate.google.com, ✈️ 谷歌服务
DOMAIN-SUFFIX,translate.googleapis.com, ✈️ 谷歌服务
DOMAIN-SUFFIX,translate-pa.googleapis.com, ✈️ 谷歌服务
DOMAIN-SUFFIX,lens.google.com, ✈️ 谷歌服务
DOMAIN-SUFFIX,lens-pa.googleapis.com, ✈️ 谷歌服务
DOMAIN-SUFFIX,clients4.google.com, ✈️ 谷歌服务
DOMAIN-SUFFIX,clients2.google.com, ✈️ 谷歌服务
DOMAIN-SUFFIX,mtalk.google.com, ✈️ 谷歌服务

IP-CIDR,192.168.1.0/24, wireguard路由器, no-resolve
GEOIP,CN, 🌍 全球直连, no-resolve
FINAL, 🐟 漏网之鱼

[Host]
localhost = 127.0.0.1

[URL Rewrite]
^https?://(www\.)?g\.cn https://www.google.com 302
^https?://(www\.)?google\.cn https://www.google.com 302
